# Транзакции
Это способ выполнения запросов, гарантирующий, что в случае ошибки все сделаенные в рамках транзакции
изменения будут отменены. Транзакция объединяет последовательность действий в одну операцию по принципу всё или ничего.
Или все команды в рамках транзакции будут выполнены до конца, или ни одна инструкция не выполнится.

## Характеристики транзакции - ACID
  1. A-Атомарность - все операции транзакции выполняются атомарно, то есть *целиком*. Если выполнены лишь некоторые инструкции, транзакция считается неуспешной и полностью откатывается.
  2. С-Согласованность - транзакция переводит БД из одного согласованного состояния в дургое
  3. I-Изолированность - каждая транзакция выполняется сама по себе, без взаимодействия с другими.
  4. D-Надежность - по завершении транзакции все внесённые ею изменения фиксируются в бд

## Транзакции в SQL
Команда *BEGIN* начинает транзакцию, все операторы после этой команды и до *COMMIT* или *ROLLBACK* будут выполняться в ней. 
*COMMIT* - фиксирует текующую транзакцию: все выполненые изменения становятся видимыми для других и гарантировано сохрнатся в случае сбоя

```
  BEGIN; -- шаг 1: начинаем транзакцию
  
  UPDATE accounts SET balance = balance - 100.00 WHERE name = 'София';
  UPDATE bank_balance SET balance = balance - 100.00 WHERE name = (SELECT bank_name FROM accounts WHERE name = 'София'); -- шаг 2: списываем средства со счёта Софии
  
  UPDATE accounts SET balance = balance + 100.00 WHERE name = 'Тимофей';
  UPDATE bank_balance SET balance = balance + 100.00 WHERE name = (SELECT bank_name FROM accounts WHERE name = 'Тимофей'); -- шаг 3: зачисляем средства на счёт Тимофея
  
  COMMIT; -- шаг 4: завершаем транзакцию 
```
